doctype html
html
  head
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    meta(name='viewport', content='width=device-width, initial-scale=1.0, shrink-to-fit=no')
    meta(name='description' content='Loan System')
    meta(name='author' content='Ma. Camille G. Maulion')
    meta(name='csrf-token', content=_csrf)
    title #{title} - VMO EZ Loan
    link(rel='shortcut icon', href='/favicon.ico')
    link(href='/css/all.css' rel='stylesheet' type='text/css')
    link(href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css')
    link(href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css')
    link(href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css')
    link(href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css')
    link(href='https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i' rel='stylesheet' type='text/css')
    link(href='/css/dataTables.bootstrap4.min.css' rel='stylesheet')
    link(href='http://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/south-street/jquery-ui.css' rel='stylesheet' type='text/css')
    link(href='/css/sb-admin-2.css' rel='stylesheet')
    block head

  body#page-top
    
    #wrapper
      include partials/header
      block content
      include partials/footer

    script(src='/js/jquery.min.js')
    script(src='/js/jquery.validate.min.js')
    script(src='/js/bootstrap.bundle.min.js')
    script(src='/js/jquery.easing.min.js')
    script(src='/js/methods.js')
    script(src='/js/sb-admin-2.js')
    script(src='/js/chart.min.js')
    script(src='/js/jquery.dataTables.min.js')
    script(src='/js/dataTables.bootstrap4.min.js')
    script(src='/js/datatables.js')
    script(src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js')
    script(src='/js/jquery.signature.js')

    if title.indexOf("Profile") != -1
      script.
          $(function () {
              $('input[name="profilePic"]').change(function () {
                  $("form#profilePicForm").submit();
              });
              $('a#verifyMobileNum').click(function () {
                let path = ($('a#verifyMobileNum').prop('href')).split('/');
                let mobileNum = path[path.length-1];
                let firstName = path[path.length-2];
                let token = $('input[name="_csrf"]').attr('value');
                $.ajaxSetup({
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader('X-CSRF-Token', token);
                    }
                });
                $.ajax({
                    url: "/api/sendOTP",
                    type: "POST",
                    data: {
                        mobileNum: mobileNum,
                        name: firstName
                    },
                    cache: false,
                    success: function (data) {
                        $('#codeModal').modal('show'); 
                    },
                    error: function (xhr, status, error) {
                       console.log(xhr.responseJSON.message);
                    }
                });
              });
          });

    if title.indexOf("Security") != -1
      script.
          $(function () {
              $('select#inputQuestion2 option[value="' + $('select#inputQuestion1').val() + '"]').hide();
              $('select#inputQuestion3 option[value="' + $('select#inputQuestion1').val() + '"]').hide();
              $('select#inputQuestion1 option[value="' + $('select#inputQuestion2').val() + '"]').hide();
              $('select#inputQuestion3 option[value="' + $('select#inputQuestion2').val() + '"]').hide();
              $('select#inputQuestion1 option[value="' + $('select#inputQuestion3').val() + '"]').hide();
              $('select#inputQuestion2 option[value="' + $('select#inputQuestion3').val() + '"]').hide();
              $('select#inputQuestion1').change(function () {
                  $('select#inputQuestion2 option[value="' + $('select#inputQuestion1').val() + '"]').hide();
                  $('select#inputQuestion3 option[value="' + $('select#inputQuestion1').val() + '"]').hide();
              });
              $('select#inputQuestion2').change(function () {
                  $('select#inputQuestion1 option[value="' + $('select#inputQuestion2').val() + '"]').hide();
                  $('select#inputQuestion3 option[value="' + $('select#inputQuestion2').val() + '"]').hide();
              });
              $('select#inputQuestion3').change(function () {
                  $('select#inputQuestion1 option[value="' + $('select#inputQuestion3').val() + '"]').hide();
                  $('select#inputQuestion2 option[value="' + $('select#inputQuestion3').val() + '"]').hide();
              });
          });

    if title == "Account Management - Verifications"
      script(src='/js/chart-pie.js')

    if title.indexOf("Address") != -1
      script.
        $(function () {
          let boxChecked = function () {
            if ($("input[name=sameAddress]:checked").length == 1){
                $("input[name=sameAddress]").val("true");
                $("input[name=unitNo2]").val( $("input[name=unitNo]").val());
                $("input[name=unitNo2]").prop('disabled', true);
                $("input[name=houseNo2]").val( $("input[name=houseNo]").val());
                $("input[name=houseNo2]").prop('disabled', true);
                $("input[name=street2]").val( $("input[name=street]").val());
                $("input[name=street2]").prop('disabled', true);
                $("input[name=subdivision2]").val( $("input[name=subdivision]").val());
                $("input[name=subdivision2]").prop('disabled', true);
                $("input[name=barangay2]").val( $("input[name=barangay]").val());
                $("input[name=barangay2]").prop('disabled', true);
                $("input[name=city2]").val( $("input[name=city]").val());
                $("input[name=city2]").prop('disabled', true);
                $("input[name=province2]").val( $("input[name=province]").val());
                $("input[name=province2]").prop('disabled', true);
                $("input[name=zipCode2]").val( $("input[name=zipCode]").val());
                $("input[name=zipCode2]").prop('disabled', true);
            } else{
                $("input[name=sameAddress]").val("false");
                $("input[name=unitNo2]").prop('disabled', false);
                $("input[name=houseNo2]").prop('disabled', false);
                $("input[name=street2]").prop('disabled', false);
                $("input[name=subdivision2]").prop('disabled', false);
                $("input[name=barangay2]").prop('disabled', false);
                $("input[name=city2]").prop('disabled', false);
                $("input[name=province2]").prop('disabled', false);
                $("input[name=zipCode2]").prop('disabled', false);
            }
          };
          boxChecked();
          $("input[name=sameAddress]").on("click", boxChecked);
        });

    if title.indexOf("Financial Questionnaire") != -1
      script.
        $(function () {
          let radioChecked = function () {
            if ($('input[name="mop"]:checked').length == 1 && $('input[name="mop"]:checked')[0].value == "Bank Transfer") {
              $('.bank').show();
              $('.gcash').hide();
            } else if ($('input[name="mop"]:checked').length == 1 && $('input[name="mop"]:checked')[0].value == "G-Cash") {
              $('.gcash').show();
              $('.bank').hide();
            } else{
              $('.gcash').hide();
              $('.bank').hide();
            }
          };
          radioChecked();
          $('input[name="mop"]').on("click", radioChecked);
        });

    if title.indexOf("Identity Documentation") != -1
      script.
        $(function () {
          let radioChecked = function () {
            if ($('input[name="identity2Options"]:checked')[0].value == "Company") {
              $('.company-id').show();
              $('.coe').hide();
            } else if ($('input[name="identity2Options"]:checked')[0].value == "COE") {
              $('.coe').show();
              $('.company-id').hide();
            }
            if ($('input[name="identity3Options"]:checked')[0].value == "Payslip") {
              $('.payslip').show();
              $('.bir').hide();
            } else if ($('input[name="identity3Options"]:checked')[0].value == "BIR") {
              $('.bir').show();
              $('.payslip').hide();
            }
          };
          radioChecked();
          $("input[type=radio]").on("click", radioChecked);
        });

    if title.indexOf("KYC Declaration") != -1
      script.
        $(function () {
          let boxChecked = function () {
            if ($('input[name="termsAndCondition"]:checked').length == 1) {
              $('input[name="termsAndCondition"]').val("true");
            } else {
              $('input[name="termsAndCondition"]').val("false");
            }
            if ($('input[name="privacyPolicy"]:checked').length == 1) {
              $('input[name="privacyPolicy"]').val("true");
            } else {
              $('input[name="privacyPolicy"]').val("false");
            }
            if ($('input[name="soa"]:checked').length == 1) {
              $('input[name="soa"]').val("true");
            } else {
              $('input[name="soa"]').val("false");
            }
             if ($('input[name="letterOfAuthorization"]:checked').length == 1) {
              $('input[name="letterOfAuthorization"]').val("true");
            } else {
              $('input[name="letterOfAuthorization"]').val("false");
            }
          };
          boxChecked();
          $('input[type="checkbox"]').on("click", boxChecked);
          var sig = $('#sig').signature();
          $('#clear').click(function () {
            sig.signature('clear');
          });
          $('#redrawButton').click(function () {
            $('#signatureDataURL').val(sig.signature('toJSON'));
            var signature = JSON.parse($('#signatureDataURL').val());
            if (signature.lines.length > 0) {
              $('#defaultSignature').attr("src", sig.signature('toDataURL', 'image/jpeg'));
              $('#signatureDataURL').val(sig.signature('toDataURL', 'image/jpeg'));
            }
            else {
              $('#defaultSignature').attr("src", "img/icon_signature.png");
              $('#signatureDataURL').val("");
            }
          });
          $('#redrawSignature').signature({ disabled: true });
        });
